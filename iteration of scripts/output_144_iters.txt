Sweep runner ready. Edit SWEEP_SETTINGS, then call `run_booster_sweep()`.
- trials file: /content/drive/MyDrive/bot_or_not_McHacks_2026/artifacts/booster_sweep_trials.csv
- notebook path: /content/drive/MyDrive/bot_or_not_McHacks_2026/script.ipynb
Loaded booster source from: /content/drive/MyDrive/bot_or_not_McHacks_2026/script.ipynb
Starting sweep: trials=150, include_current=True, without_replacement=True, space_size=209,952

[1/150] Running week_sweep_0001 ...
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.250         58               16                0                3          96                26                 0                 4
regularized    1.0      0.195         62               16                0                1          92                26                 0                 6
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1950
Second-stage test score: 92/104 (88.46%)
Second-stage confusion components -> TP=26, FN=0, FP=6
Second-stage precision=0.8125, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9286    0.9630        84
           1     0.8125    1.0000    0.8966        26

    accuracy                         0.9455       110
   macro avg     0.9062    0.9643    0.9298       110
weighted avg     0.9557    0.9455    0.9473       110

week_sweep_0001: booster=92.0, ensemble=77.0, gain=15.0, dur=140.7s

[2/150] Running week_sweep_0002 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0       0.31         52               16                0                6          88                26                 0                 8
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.3100
Second-stage test score: 88/104 (84.62%)
Second-stage confusion components -> TP=26, FN=0, FP=8
Second-stage precision=0.7647, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9048    0.9500        84
           1     0.7647    1.0000    0.8667        26

    accuracy                         0.9273       110
   macro avg     0.8824    0.9524    0.9083       110
weighted avg     0.9444    0.9273    0.9303       110

week_sweep_0002: booster=88.0, ensemble=77.0, gain=11.0, dur=104.3s

[3/150] Running week_sweep_0003 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
regularized    1.0      0.310         55               15                1                2         100                26                 0                 2
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0003: booster=102.0, ensemble=77.0, gain=25.0, dur=124.3s

[4/150] Running week_sweep_0004 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.120         59               15                1                0         102                26                 0                 1
regularized    1.0      0.375         56               16                0                4          77                23                 3                 6
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0004: booster=102.0, ensemble=77.0, gain=25.0, dur=93.0s

[5/150] Running week_sweep_0005 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0005: booster=102.0, ensemble=77.0, gain=25.0, dur=123.4s

[6/150] Running week_sweep_0006 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.105         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1050
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0006: booster=102.0, ensemble=77.0, gain=25.0, dur=123.0s

[7/150] Running week_sweep_0007 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    0.9       0.12         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0007: booster=102.0, ensemble=77.0, gain=25.0, dur=94.0s

[8/150] Running week_sweep_0008 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0008: booster=84.0, ensemble=77.0, gain=7.0, dur=105.4s

[9/150] Running week_sweep_0009 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    0.9      0.120         64               16                0                0         102                26                 0                 1
regularized    0.9      0.105         64               16                0                0          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0009: booster=102.0, ensemble=77.0, gain=25.0, dur=94.4s

[10/150] Running week_sweep_0010 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
regularized    1.0      0.245         62               16                0                1          95                25                 1                 2
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0010: booster=102.0, ensemble=77.0, gain=25.0, dur=124.7s

[11/150] Running week_sweep_0011 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.250         58               16                0                3          96                26                 0                 4
regularized    1.0      0.375         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.3750
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0011: booster=96.0, ensemble=77.0, gain=19.0, dur=140.8s

[12/150] Running week_sweep_0012 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.305         57               15                1                1         100                26                 0                 2
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.3050
Second-stage test score: 100/104 (96.15%)
Second-stage confusion components -> TP=26, FN=0, FP=2
Second-stage precision=0.9286, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9762    0.9880        84
           1     0.9286    1.0000    0.9630        26

    accuracy                         0.9818       110
   macro avg     0.9643    0.9881    0.9755       110
weighted avg     0.9831    0.9818    0.9820       110

week_sweep_0012: booster=100.0, ensemble=77.0, gain=23.0, dur=144.6s

[13/150] Running week_sweep_0013 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0013: booster=84.0, ensemble=77.0, gain=7.0, dur=107.3s

[14/150] Running week_sweep_0014 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0014: booster=84.0, ensemble=77.0, gain=7.0, dur=103.2s

[15/150] Running week_sweep_0015 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
regularized    1.0       0.35         54               16                0                5          75                25                 1                12
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0015: booster=96.0, ensemble=77.0, gain=19.0, dur=147.9s

[16/150] Running week_sweep_0016 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0       0.25         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0016: booster=96.0, ensemble=77.0, gain=19.0, dur=143.3s

[17/150] Running week_sweep_0017 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.275         54               14                2                0          92                24                 2                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2750
Second-stage test score: 92/104 (88.46%)
Second-stage confusion components -> TP=24, FN=2, FP=1
Second-stage precision=0.9600, recall=0.9231
              precision    recall  f1-score   support

           0     0.9765    0.9881    0.9822        84
           1     0.9600    0.9231    0.9412        26

    accuracy                         0.9727       110
   macro avg     0.9682    0.9556    0.9617       110
weighted avg     0.9726    0.9727    0.9725       110

week_sweep_0017: booster=92.0, ensemble=77.0, gain=15.0, dur=94.5s

[18/150] Running week_sweep_0018 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.515         54               14                2                0          95                25                 1                 2
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.5150
Second-stage test score: 95/104 (91.35%)
Second-stage confusion components -> TP=25, FN=1, FP=2
Second-stage precision=0.9259, recall=0.9615
              precision    recall  f1-score   support

           0     0.9880    0.9762    0.9820        84
           1     0.9259    0.9615    0.9434        26

    accuracy                         0.9727       110
   macro avg     0.9569    0.9689    0.9627       110
weighted avg     0.9733    0.9727    0.9729       110

week_sweep_0018: booster=95.0, ensemble=77.0, gain=18.0, dur=100.9s

[19/150] Running week_sweep_0019 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.395         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.3950
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0019: booster=96.0, ensemble=77.0, gain=19.0, dur=139.9s

[20/150] Running week_sweep_0020 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0020: booster=84.0, ensemble=77.0, gain=7.0, dur=101.5s

[21/150] Running week_sweep_0021 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    0.9       0.12         64               16                0                0         102                26                 0                 1
regularized    0.9       0.40         57               15                1                1          83                23                 3                 3
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0021: booster=102.0, ensemble=77.0, gain=25.0, dur=92.2s

[22/150] Running week_sweep_0022 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    0.9       0.12         64               16                0                0         102                26                 0                 1
regularized    1.0       0.35         64               16                0                0          97                25                 1                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.3500
Second-stage test score: 97/104 (93.27%)
Second-stage confusion components -> TP=25, FN=1, FP=1
Second-stage precision=0.9615, recall=0.9615
              precision    recall  f1-score   support

           0     0.9881    0.9881    0.9881        84
           1     0.9615    0.9615    0.9615        26

    accuracy                         0.9818       110
   macro avg     0.9748    0.9748    0.9748       110
weighted avg     0.9818    0.9818    0.9818       110

week_sweep_0022: booster=97.0, ensemble=77.0, gain=20.0, dur=96.3s

[23/150] Running week_sweep_0023 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
regularized    1.0      0.400         59               15                1                0          92                24                 2                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0023: booster=102.0, ensemble=77.0, gain=25.0, dur=123.8s

[24/150] Running week_sweep_0024 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.120         59               15                1                0         102                26                 0                 1
regularized    1.0      0.355         64               16                0                0          90                24                 2                 2
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.3550
Second-stage test score: 90/104 (86.54%)
Second-stage confusion components -> TP=24, FN=2, FP=2
Second-stage precision=0.9231, recall=0.9231
              precision    recall  f1-score   support

           0     0.9762    0.9762    0.9762        84
           1     0.9231    0.9231    0.9231        26

    accuracy                         0.9636       110
   macro avg     0.9496    0.9496    0.9496       110
weighted avg     0.9636    0.9636    0.9636       110

week_sweep_0024: booster=90.0, ensemble=77.0, gain=13.0, dur=95.5s

[25/150] Running week_sweep_0025 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
regularized    1.0      0.185         64               16                0                0          98                26                 0                 3
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1850
Second-stage test score: 98/104 (94.23%)
Second-stage confusion components -> TP=26, FN=0, FP=3
Second-stage precision=0.8966, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9643    0.9818        84
           1     0.8966    1.0000    0.9455        26

    accuracy                         0.9727       110
   macro avg     0.9483    0.9821    0.9636       110
weighted avg     0.9755    0.9727    0.9732       110

week_sweep_0025: booster=98.0, ensemble=77.0, gain=21.0, dur=125.0s

[26/150] Running week_sweep_0026 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.405         54               14                2                0          95                25                 1                 2
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.4050
Second-stage test score: 95/104 (91.35%)
Second-stage confusion components -> TP=25, FN=1, FP=2
Second-stage precision=0.9259, recall=0.9615
              precision    recall  f1-score   support

           0     0.9880    0.9762    0.9820        84
           1     0.9259    0.9615    0.9434        26

    accuracy                         0.9727       110
   macro avg     0.9569    0.9689    0.9627       110
weighted avg     0.9733    0.9727    0.9729       110

week_sweep_0026: booster=95.0, ensemble=77.0, gain=18.0, dur=102.5s

[27/150] Running week_sweep_0027 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0       0.33         59               15                1                0          92                24                 2                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.3300
Second-stage test score: 92/104 (88.46%)
Second-stage confusion components -> TP=24, FN=2, FP=1
Second-stage precision=0.9600, recall=0.9231
              precision    recall  f1-score   support

           0     0.9765    0.9881    0.9822        84
           1     0.9600    0.9231    0.9412        26

    accuracy                         0.9727       110
   macro avg     0.9682    0.9556    0.9617       110
weighted avg     0.9726    0.9727    0.9725       110

week_sweep_0027: booster=92.0, ensemble=77.0, gain=15.0, dur=124.0s

[28/150] Running week_sweep_0028 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    0.9       0.12         64               16                0                0         102                26                 0                 1
regularized    0.9       0.38         58               16                0                3          80                24                 2                 7
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0028: booster=102.0, ensemble=77.0, gain=25.0, dur=95.5s

[29/150] Running week_sweep_0029 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
regularized    1.0       0.47         53               15                1                3          89                25                 1                 5
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0029: booster=96.0, ensemble=77.0, gain=19.0, dur=145.1s

[30/150] Running week_sweep_0030 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.485         57               15                1                1          89                25                 1                 5
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.4850
Second-stage test score: 89/104 (85.58%)
Second-stage confusion components -> TP=25, FN=1, FP=5
Second-stage precision=0.8333, recall=0.9615
              precision    recall  f1-score   support

           0     0.9875    0.9405    0.9634        84
           1     0.8333    0.9615    0.8929        26

    accuracy                         0.9455       110
   macro avg     0.9104    0.9510    0.9281       110
weighted avg     0.9511    0.9455    0.9467       110

week_sweep_0030: booster=89.0, ensemble=77.0, gain=12.0, dur=144.6s

[31/150] Running week_sweep_0031 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.120         59               15                1                0         102                26                 0                 1
regularized    1.0      0.275         62               16                0                1          91                25                 1                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2750
Second-stage test score: 91/104 (87.50%)
Second-stage confusion components -> TP=25, FN=1, FP=4
Second-stage precision=0.8621, recall=0.9615
              precision    recall  f1-score   support

           0     0.9877    0.9524    0.9697        84
           1     0.8621    0.9615    0.9091        26

    accuracy                         0.9545       110
   macro avg     0.9249    0.9570    0.9394       110
weighted avg     0.9580    0.9545    0.9554       110

week_sweep_0031: booster=91.0, ensemble=77.0, gain=14.0, dur=94.5s

[32/150] Running week_sweep_0032 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0032: booster=102.0, ensemble=77.0, gain=25.0, dur=122.0s

[33/150] Running week_sweep_0033 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.385         56               16                0                4          88                26                 0                 8
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.3850
Second-stage test score: 88/104 (84.62%)
Second-stage confusion components -> TP=26, FN=0, FP=8
Second-stage precision=0.7647, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9048    0.9500        84
           1     0.7647    1.0000    0.8667        26

    accuracy                         0.9273       110
   macro avg     0.8824    0.9524    0.9083       110
weighted avg     0.9444    0.9273    0.9303       110

week_sweep_0033: booster=88.0, ensemble=77.0, gain=11.0, dur=141.9s

[34/150] Running week_sweep_0034 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
regularized    1.0       0.21         58               16                0                3          88                26                 0                 8
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2100
Second-stage test score: 88/104 (84.62%)
Second-stage confusion components -> TP=26, FN=0, FP=8
Second-stage precision=0.7647, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9048    0.9500        84
           1     0.7647    1.0000    0.8667        26

    accuracy                         0.9273       110
   macro avg     0.8824    0.9524    0.9083       110
weighted avg     0.9444    0.9273    0.9303       110

week_sweep_0034: booster=88.0, ensemble=77.0, gain=11.0, dur=105.2s

[35/150] Running week_sweep_0035 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
regularized    1.0       0.21         58               16                0                3          88                26                 0                 8
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2100
Second-stage test score: 88/104 (84.62%)
Second-stage confusion components -> TP=26, FN=0, FP=8
Second-stage precision=0.7647, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9048    0.9500        84
           1     0.7647    1.0000    0.8667        26

    accuracy                         0.9273       110
   macro avg     0.8824    0.9524    0.9083       110
weighted avg     0.9444    0.9273    0.9303       110

week_sweep_0035: booster=88.0, ensemble=77.0, gain=11.0, dur=102.2s

[36/150] Running week_sweep_0036 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0036: booster=96.0, ensemble=77.0, gain=19.0, dur=140.9s

[37/150] Running week_sweep_0037 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0       0.42         59               15                1                0          91                25                 1                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.4200
Second-stage test score: 91/104 (87.50%)
Second-stage confusion components -> TP=25, FN=1, FP=4
Second-stage precision=0.8621, recall=0.9615
              precision    recall  f1-score   support

           0     0.9877    0.9524    0.9697        84
           1     0.8621    0.9615    0.9091        26

    accuracy                         0.9545       110
   macro avg     0.9249    0.9570    0.9394       110
weighted avg     0.9580    0.9545    0.9554       110

week_sweep_0037: booster=91.0, ensemble=77.0, gain=14.0, dur=103.8s

[38/150] Running week_sweep_0038 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.465         53               15                1                3          82                24                 2                 6
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.4650
Second-stage test score: 82/104 (78.85%)
Second-stage confusion components -> TP=24, FN=2, FP=6
Second-stage precision=0.8000, recall=0.9231
              precision    recall  f1-score   support

           0     0.9750    0.9286    0.9512        84
           1     0.8000    0.9231    0.8571        26

    accuracy                         0.9273       110
   macro avg     0.8875    0.9258    0.9042       110
weighted avg     0.9336    0.9273    0.9290       110

week_sweep_0038: booster=82.0, ensemble=77.0, gain=5.0, dur=141.7s

[39/150] Running week_sweep_0039 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.165         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1650
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0039: booster=96.0, ensemble=77.0, gain=19.0, dur=101.6s

[40/150] Running week_sweep_0040 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0040: booster=96.0, ensemble=77.0, gain=19.0, dur=138.7s

[41/150] Running week_sweep_0041 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.165         64               16                0                0          98                26                 0                 3
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1650
Second-stage test score: 98/104 (94.23%)
Second-stage confusion components -> TP=26, FN=0, FP=3
Second-stage precision=0.8966, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9643    0.9818        84
           1     0.8966    1.0000    0.9455        26

    accuracy                         0.9727       110
   macro avg     0.9483    0.9821    0.9636       110
weighted avg     0.9755    0.9727    0.9732       110

week_sweep_0041: booster=98.0, ensemble=77.0, gain=21.0, dur=123.2s

[42/150] Running week_sweep_0042 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.250         58               16                0                3          96                26                 0                 4
regularized    1.0      0.285         60               16                0                2          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2850
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0042: booster=96.0, ensemble=77.0, gain=19.0, dur=140.6s

[43/150] Running week_sweep_0043 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.12         59               15                1                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0043: booster=102.0, ensemble=77.0, gain=25.0, dur=93.7s

[44/150] Running week_sweep_0044 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0       0.28         62               16                0                1          88                26                 0                 8
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2800
Second-stage test score: 88/104 (84.62%)
Second-stage confusion components -> TP=26, FN=0, FP=8
Second-stage precision=0.7647, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9048    0.9500        84
           1     0.7647    1.0000    0.8667        26

    accuracy                         0.9273       110
   macro avg     0.8824    0.9524    0.9083       110
weighted avg     0.9444    0.9273    0.9303       110

week_sweep_0044: booster=88.0, ensemble=77.0, gain=11.0, dur=143.4s

[45/150] Running week_sweep_0045 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
regularized    1.0      0.160         60               16                0                2          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0045: booster=102.0, ensemble=77.0, gain=25.0, dur=123.2s

[46/150] Running week_sweep_0046 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
regularized    1.0      0.180         59               15                1                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0046: booster=102.0, ensemble=77.0, gain=25.0, dur=125.1s

[47/150] Running week_sweep_0047 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    0.9      0.175         62               16                0                1          92                26                 0                 6
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.1750
Second-stage test score: 92/104 (88.46%)
Second-stage confusion components -> TP=26, FN=0, FP=6
Second-stage precision=0.8125, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9286    0.9630        84
           1     0.8125    1.0000    0.8966        26

    accuracy                         0.9455       110
   macro avg     0.9062    0.9643    0.9298       110
weighted avg     0.9557    0.9455    0.9473       110

week_sweep_0047: booster=92.0, ensemble=77.0, gain=15.0, dur=106.6s

[48/150] Running week_sweep_0048 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0048: booster=84.0, ensemble=77.0, gain=7.0, dur=105.2s

[49/150] Running week_sweep_0049 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    0.9       0.12         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0049: booster=102.0, ensemble=77.0, gain=25.0, dur=94.3s

[50/150] Running week_sweep_0050 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0       0.16         62               16                0                1          98                26                 0                 3
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1600
Second-stage test score: 98/104 (94.23%)
Second-stage confusion components -> TP=26, FN=0, FP=3
Second-stage precision=0.8966, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9643    0.9818        84
           1     0.8966    1.0000    0.9455        26

    accuracy                         0.9727       110
   macro avg     0.9483    0.9821    0.9636       110
weighted avg     0.9755    0.9727    0.9732       110

week_sweep_0050: booster=98.0, ensemble=77.0, gain=21.0, dur=95.7s

[51/150] Running week_sweep_0051 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
regularized    1.0       0.43         52               16                0                6          88                26                 0                 8
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0051: booster=84.0, ensemble=77.0, gain=7.0, dur=103.6s

[52/150] Running week_sweep_0052 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.12         59               15                1                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0052: booster=102.0, ensemble=77.0, gain=25.0, dur=93.0s

[53/150] Running week_sweep_0053 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
regularized    1.0       0.42         55               15                1                2          98                26                 0                 3
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0053: booster=96.0, ensemble=77.0, gain=19.0, dur=139.2s

[54/150] Running week_sweep_0054 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
regularized    1.0       0.16         57               15                1                1          98                26                 0                 3
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1600
Second-stage test score: 98/104 (94.23%)
Second-stage confusion components -> TP=26, FN=0, FP=3
Second-stage precision=0.8966, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9643    0.9818        84
           1     0.8966    1.0000    0.9455        26

    accuracy                         0.9727       110
   macro avg     0.9483    0.9821    0.9636       110
weighted avg     0.9755    0.9727    0.9732       110

week_sweep_0054: booster=98.0, ensemble=77.0, gain=21.0, dur=102.3s

[55/150] Running week_sweep_0055 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
regularized    1.0      0.125         64               16                0                0          92                26                 0                 6
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0055: booster=102.0, ensemble=77.0, gain=25.0, dur=124.2s

[56/150] Running week_sweep_0056 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.415         60               16                0                2          98                26                 0                 3
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.4150
Second-stage test score: 98/104 (94.23%)
Second-stage confusion components -> TP=26, FN=0, FP=3
Second-stage precision=0.8966, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9643    0.9818        84
           1     0.8966    1.0000    0.9455        26

    accuracy                         0.9727       110
   macro avg     0.9483    0.9821    0.9636       110
weighted avg     0.9755    0.9727    0.9732       110

week_sweep_0056: booster=98.0, ensemble=77.0, gain=21.0, dur=143.4s

[57/150] Running week_sweep_0057 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
regularized    0.9       0.24         60               16                0                2          88                26                 0                 8
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.2400
Second-stage test score: 88/104 (84.62%)
Second-stage confusion components -> TP=26, FN=0, FP=8
Second-stage precision=0.7647, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9048    0.9500        84
           1     0.7647    1.0000    0.8667        26

    accuracy                         0.9273       110
   macro avg     0.8824    0.9524    0.9083       110
weighted avg     0.9444    0.9273    0.9303       110

week_sweep_0057: booster=88.0, ensemble=77.0, gain=11.0, dur=101.5s

[58/150] Running week_sweep_0058 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0058: booster=84.0, ensemble=77.0, gain=7.0, dur=101.5s

[59/150] Running week_sweep_0059 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    0.9       0.12         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0059: booster=102.0, ensemble=77.0, gain=25.0, dur=96.6s

[60/150] Running week_sweep_0060 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.205         62               16                0                1          98                26                 0                 3
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2050
Second-stage test score: 98/104 (94.23%)
Second-stage confusion components -> TP=26, FN=0, FP=3
Second-stage precision=0.8966, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9643    0.9818        84
           1     0.8966    1.0000    0.9455        26

    accuracy                         0.9727       110
   macro avg     0.9483    0.9821    0.9636       110
weighted avg     0.9755    0.9727    0.9732       110

week_sweep_0060: booster=98.0, ensemble=77.0, gain=21.0, dur=125.7s

[61/150] Running week_sweep_0061 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
regularized    1.0       0.52         62               16                0                1          92                24                 2                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.5200
Second-stage test score: 92/104 (88.46%)
Second-stage confusion components -> TP=24, FN=2, FP=1
Second-stage precision=0.9600, recall=0.9231
              precision    recall  f1-score   support

           0     0.9765    0.9881    0.9822        84
           1     0.9600    0.9231    0.9412        26

    accuracy                         0.9727       110
   macro avg     0.9682    0.9556    0.9617       110
weighted avg     0.9726    0.9727    0.9725       110

week_sweep_0061: booster=92.0, ensemble=77.0, gain=15.0, dur=142.2s

[62/150] Running week_sweep_0062 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.345         64               16                0                0          93                25                 1                 3
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.3450
Second-stage test score: 93/104 (89.42%)
Second-stage confusion components -> TP=25, FN=1, FP=3
Second-stage precision=0.8929, recall=0.9615
              precision    recall  f1-score   support

           0     0.9878    0.9643    0.9759        84
           1     0.8929    0.9615    0.9259        26

    accuracy                         0.9636       110
   macro avg     0.9403    0.9629    0.9509       110
weighted avg     0.9654    0.9636    0.9641       110

week_sweep_0062: booster=93.0, ensemble=77.0, gain=16.0, dur=93.6s

[63/150] Running week_sweep_0063 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    0.9      0.120         64               16                0                0         102                26                 0                 1
regularized    1.0      0.105         64               16                0                0          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0063: booster=102.0, ensemble=77.0, gain=25.0, dur=96.7s

[64/150] Running week_sweep_0064 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0064: booster=96.0, ensemble=77.0, gain=19.0, dur=141.5s

[65/150] Running week_sweep_0065 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.670         54               14                2                0          84                22                 4                 0
regularized    1.0      0.265         62               16                0                1          98                26                 0                 3
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2650
Second-stage test score: 98/104 (94.23%)
Second-stage confusion components -> TP=26, FN=0, FP=3
Second-stage precision=0.8966, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9643    0.9818        84
           1     0.8966    1.0000    0.9455        26

    accuracy                         0.9727       110
   macro avg     0.9483    0.9821    0.9636       110
weighted avg     0.9755    0.9727    0.9732       110

week_sweep_0065: booster=98.0, ensemble=77.0, gain=21.0, dur=103.4s

[66/150] Running week_sweep_0066 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
regularized    1.0       0.20         56               16                0                4          84                26                 0                10
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2000
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=26, FN=0, FP=10
Second-stage precision=0.7222, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.8810    0.9367        84
           1     0.7222    1.0000    0.8387        26

    accuracy                         0.9091       110
   macro avg     0.8611    0.9405    0.8877       110
weighted avg     0.9343    0.9091    0.9135       110

week_sweep_0066: booster=84.0, ensemble=77.0, gain=7.0, dur=103.4s

[67/150] Running week_sweep_0067 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
regularized    1.0       0.32         52               16                0                6          80                26                 0                12
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0067: booster=84.0, ensemble=77.0, gain=7.0, dur=102.2s

[68/150] Running week_sweep_0068 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
regularized    1.0      0.320         62               16                0                1          93                25                 1                 3
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0068: booster=102.0, ensemble=77.0, gain=25.0, dur=124.0s

[69/150] Running week_sweep_0069 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0069: booster=84.0, ensemble=77.0, gain=7.0, dur=104.1s

[70/150] Running week_sweep_0070 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0070: booster=84.0, ensemble=77.0, gain=7.0, dur=103.5s

[71/150] Running week_sweep_0071 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.250         58               16                0                3          96                26                 0                 4
regularized    1.0      0.415         54               16                0                5          90                26                 0                 7
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0071: booster=96.0, ensemble=77.0, gain=19.0, dur=141.0s

[72/150] Running week_sweep_0072 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
regularized    1.0      0.365         59               15                1                0          87                23                 3                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0072: booster=102.0, ensemble=77.0, gain=25.0, dur=124.5s

[73/150] Running week_sweep_0073 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0       0.49         52               16                0                6          74                26                 0                15
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.4900
Second-stage test score: 74/104 (71.15%)
Second-stage confusion components -> TP=26, FN=0, FP=15
Second-stage precision=0.6341, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.8214    0.9020        84
           1     0.6341    1.0000    0.7761        26

    accuracy                         0.8636       110
   macro avg     0.8171    0.9107    0.8390       110
weighted avg     0.9135    0.8636    0.8722       110

week_sweep_0073: booster=74.0, ensemble=77.0, gain=-3.0, dur=141.9s

[74/150] Running week_sweep_0074 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0074: booster=84.0, ensemble=77.0, gain=7.0, dur=103.6s

[75/150] Running week_sweep_0075 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0075: booster=84.0, ensemble=77.0, gain=7.0, dur=103.5s

[76/150] Running week_sweep_0076 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.405         62               16                0                1         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.4050
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0076: booster=102.0, ensemble=77.0, gain=25.0, dur=140.2s

[77/150] Running week_sweep_0077 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    0.9      0.120         64               16                0                0         102                26                 0                 1
regularized    1.0      0.385         64               16                0                0          78                22                 4                 3
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.3850
Second-stage test score: 78/104 (75.00%)
Second-stage confusion components -> TP=22, FN=4, FP=3
Second-stage precision=0.8800, recall=0.8462
              precision    recall  f1-score   support

           0     0.9529    0.9643    0.9586        84
           1     0.8800    0.8462    0.8627        26

    accuracy                         0.9364       110
   macro avg     0.9165    0.9052    0.9107       110
weighted avg     0.9357    0.9364    0.9359       110

week_sweep_0077: booster=78.0, ensemble=77.0, gain=1.0, dur=96.8s

[78/150] Running week_sweep_0078 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0078: booster=96.0, ensemble=77.0, gain=19.0, dur=142.2s

[79/150] Running week_sweep_0079 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
regularized    1.0      0.330         64               16                0                0          87                23                 3                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.3300
Second-stage test score: 87/104 (83.65%)
Second-stage confusion components -> TP=23, FN=3, FP=1
Second-stage precision=0.9583, recall=0.8846
              precision    recall  f1-score   support

           0     0.9651    0.9881    0.9765        84
           1     0.9583    0.8846    0.9200        26

    accuracy                         0.9636       110
   macro avg     0.9617    0.9364    0.9482       110
weighted avg     0.9635    0.9636    0.9631       110

week_sweep_0079: booster=87.0, ensemble=77.0, gain=10.0, dur=129.1s

[80/150] Running week_sweep_0080 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0080: booster=102.0, ensemble=77.0, gain=25.0, dur=125.7s

[81/150] Running week_sweep_0081 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    0.9       0.12         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0081: booster=102.0, ensemble=77.0, gain=25.0, dur=97.2s

[82/150] Running week_sweep_0082 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.12         59               15                1                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0082: booster=102.0, ensemble=77.0, gain=25.0, dur=96.3s

[83/150] Running week_sweep_0083 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0083: booster=102.0, ensemble=77.0, gain=25.0, dur=126.3s

[84/150] Running week_sweep_0084 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0084: booster=84.0, ensemble=77.0, gain=7.0, dur=107.6s

[85/150] Running week_sweep_0085 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0       0.46         60               16                0                2          82                24                 2                 6
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.4600
Second-stage test score: 82/104 (78.85%)
Second-stage confusion components -> TP=24, FN=2, FP=6
Second-stage precision=0.8000, recall=0.9231
              precision    recall  f1-score   support

           0     0.9750    0.9286    0.9512        84
           1     0.8000    0.9231    0.8571        26

    accuracy                         0.9273       110
   macro avg     0.8875    0.9258    0.9042       110
weighted avg     0.9336    0.9273    0.9290       110

week_sweep_0085: booster=82.0, ensemble=77.0, gain=5.0, dur=144.5s

[86/150] Running week_sweep_0086 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
regularized    1.0       0.31         52               16                0                6          80                26                 0                12
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0086: booster=84.0, ensemble=77.0, gain=7.0, dur=106.8s

[87/150] Running week_sweep_0087 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
regularized    1.0      0.295         59               15                1                0          95                25                 1                 2
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0087: booster=102.0, ensemble=77.0, gain=25.0, dur=128.9s

[88/150] Running week_sweep_0088 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0088: booster=96.0, ensemble=77.0, gain=19.0, dur=147.0s

[89/150] Running week_sweep_0089 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    0.9       0.15         64               16                0                0         100                26                 0                 2
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.1500
Second-stage test score: 100/104 (96.15%)
Second-stage confusion components -> TP=26, FN=0, FP=2
Second-stage precision=0.9286, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9762    0.9880        84
           1     0.9286    1.0000    0.9630        26

    accuracy                         0.9818       110
   macro avg     0.9643    0.9881    0.9755       110
weighted avg     0.9831    0.9818    0.9820       110

week_sweep_0089: booster=100.0, ensemble=77.0, gain=23.0, dur=125.5s

[90/150] Running week_sweep_0090 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    0.9       0.24         60               16                0                2          88                26                 0                 8
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.2400
Second-stage test score: 88/104 (84.62%)
Second-stage confusion components -> TP=26, FN=0, FP=8
Second-stage precision=0.7647, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9048    0.9500        84
           1     0.7647    1.0000    0.8667        26

    accuracy                         0.9273       110
   macro avg     0.8824    0.9524    0.9083       110
weighted avg     0.9444    0.9273    0.9303       110

week_sweep_0090: booster=88.0, ensemble=77.0, gain=11.0, dur=104.8s

[91/150] Running week_sweep_0091 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.135         59               15                1                0          98                26                 0                 3
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1350
Second-stage test score: 98/104 (94.23%)
Second-stage confusion components -> TP=26, FN=0, FP=3
Second-stage precision=0.8966, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9643    0.9818        84
           1     0.8966    1.0000    0.9455        26

    accuracy                         0.9727       110
   macro avg     0.9483    0.9821    0.9636       110
weighted avg     0.9755    0.9727    0.9732       110

week_sweep_0091: booster=98.0, ensemble=77.0, gain=21.0, dur=124.8s

[92/150] Running week_sweep_0092 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    0.9       0.12         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0092: booster=102.0, ensemble=77.0, gain=25.0, dur=97.2s

[93/150] Running week_sweep_0093 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0        0.3         64               16                0                0          77                21                 5                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.3000
Second-stage test score: 77/104 (74.04%)
Second-stage confusion components -> TP=21, FN=5, FP=1
Second-stage precision=0.9545, recall=0.8077
              precision    recall  f1-score   support

           0     0.9432    0.9881    0.9651        84
           1     0.9545    0.8077    0.8750        26

    accuracy                         0.9455       110
   macro avg     0.9489    0.8979    0.9201       110
weighted avg     0.9459    0.9455    0.9438       110

week_sweep_0093: booster=77.0, ensemble=77.0, gain=0.0, dur=95.7s

[94/150] Running week_sweep_0094 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
regularized    1.0      0.170         64               16                0                0         100                26                 0                 2
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1700
Second-stage test score: 100/104 (96.15%)
Second-stage confusion components -> TP=26, FN=0, FP=2
Second-stage precision=0.9286, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9762    0.9880        84
           1     0.9286    1.0000    0.9630        26

    accuracy                         0.9818       110
   macro avg     0.9643    0.9881    0.9755       110
weighted avg     0.9831    0.9818    0.9820       110

week_sweep_0094: booster=100.0, ensemble=77.0, gain=23.0, dur=124.4s

[95/150] Running week_sweep_0095 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0       0.25         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0095: booster=96.0, ensemble=77.0, gain=19.0, dur=144.1s

[96/150] Running week_sweep_0096 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.305         58               16                0                3          89                25                 1                 5
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.3050
Second-stage test score: 89/104 (85.58%)
Second-stage confusion components -> TP=25, FN=1, FP=5
Second-stage precision=0.8333, recall=0.9615
              precision    recall  f1-score   support

           0     0.9875    0.9405    0.9634        84
           1     0.8333    0.9615    0.8929        26

    accuracy                         0.9455       110
   macro avg     0.9104    0.9510    0.9281       110
weighted avg     0.9511    0.9455    0.9467       110

week_sweep_0096: booster=89.0, ensemble=77.0, gain=12.0, dur=95.4s

[97/150] Running week_sweep_0097 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
regularized    1.0       0.42         53               15                1                3          89                25                 1                 5
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0097: booster=84.0, ensemble=77.0, gain=7.0, dur=106.1s

[98/150] Running week_sweep_0098 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0098: booster=102.0, ensemble=77.0, gain=25.0, dur=128.9s

[99/150] Running week_sweep_0099 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
regularized    1.0      0.295         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2950
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0099: booster=102.0, ensemble=77.0, gain=25.0, dur=126.1s

[100/150] Running week_sweep_0100 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.12         59               15                1                0         102                26                 0                 1
regularized    1.0       0.40         56               16                0                4          80                24                 2                 7
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0100: booster=102.0, ensemble=77.0, gain=25.0, dur=98.6s

[101/150] Running week_sweep_0101 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    0.9      0.120         64               16                0                0         102                26                 0                 1
regularized    1.0      0.445         57               15                1                1          82                24                 2                 6
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0101: booster=102.0, ensemble=77.0, gain=25.0, dur=96.8s

[102/150] Running week_sweep_0102 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
regularized    1.0      0.350         59               15                1                0          97                25                 1                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0102: booster=102.0, ensemble=77.0, gain=25.0, dur=130.8s

[103/150] Running week_sweep_0103 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0103: booster=84.0, ensemble=77.0, gain=7.0, dur=111.3s

[104/150] Running week_sweep_0104 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.12         59               15                1                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0104: booster=102.0, ensemble=77.0, gain=25.0, dur=97.1s

[105/150] Running week_sweep_0105 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    0.9       0.12         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0105: booster=102.0, ensemble=77.0, gain=25.0, dur=96.3s

[106/150] Running week_sweep_0106 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0106: booster=96.0, ensemble=77.0, gain=19.0, dur=145.4s

[107/150] Running week_sweep_0107 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.425         52               16                0                6          83                25                 1                 8
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.4250
Second-stage test score: 83/104 (79.81%)
Second-stage confusion components -> TP=25, FN=1, FP=8
Second-stage precision=0.7576, recall=0.9615
              precision    recall  f1-score   support

           0     0.9870    0.9048    0.9441        84
           1     0.7576    0.9615    0.8475        26

    accuracy                         0.9182       110
   macro avg     0.8723    0.9332    0.8958       110
weighted avg     0.9328    0.9182    0.9213       110

week_sweep_0107: booster=83.0, ensemble=77.0, gain=6.0, dur=148.4s

[108/150] Running week_sweep_0108 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
regularized    1.0      0.350         59               15                1                0          97                25                 1                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0108: booster=102.0, ensemble=77.0, gain=25.0, dur=127.7s

[109/150] Running week_sweep_0109 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0109: booster=96.0, ensemble=77.0, gain=19.0, dur=148.8s

[110/150] Running week_sweep_0110 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    0.9       0.26         64               16                0                0          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.2600
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0110: booster=96.0, ensemble=77.0, gain=19.0, dur=146.5s

[111/150] Running week_sweep_0111 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0111: booster=102.0, ensemble=77.0, gain=25.0, dur=127.4s

[112/150] Running week_sweep_0112 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    0.9       0.12         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0112: booster=102.0, ensemble=77.0, gain=25.0, dur=98.8s

[113/150] Running week_sweep_0113 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.405         59               15                1                0          98                26                 0                 3
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.4050
Second-stage test score: 98/104 (94.23%)
Second-stage confusion components -> TP=26, FN=0, FP=3
Second-stage precision=0.8966, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9643    0.9818        84
           1     0.8966    1.0000    0.9455        26

    accuracy                         0.9727       110
   macro avg     0.9483    0.9821    0.9636       110
weighted avg     0.9755    0.9727    0.9732       110

week_sweep_0113: booster=98.0, ensemble=77.0, gain=21.0, dur=106.6s

[114/150] Running week_sweep_0114 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0       0.44         50               16                0                7          76                26                 0                14
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.4400
Second-stage test score: 76/104 (73.08%)
Second-stage confusion components -> TP=26, FN=0, FP=14
Second-stage precision=0.6500, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.8333    0.9091        84
           1     0.6500    1.0000    0.7879        26

    accuracy                         0.8727       110
   macro avg     0.8250    0.9167    0.8485       110
weighted avg     0.9173    0.8727    0.8804       110

week_sweep_0114: booster=76.0, ensemble=77.0, gain=-1.0, dur=110.8s

[115/150] Running week_sweep_0115 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0115: booster=84.0, ensemble=77.0, gain=7.0, dur=115.5s

[116/150] Running week_sweep_0116 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    0.9       0.12         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0116: booster=102.0, ensemble=77.0, gain=25.0, dur=96.8s

[117/150] Running week_sweep_0117 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0117: booster=96.0, ensemble=77.0, gain=19.0, dur=150.4s

[118/150] Running week_sweep_0118 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
regularized    1.0       0.21         58               16                0                3          88                26                 0                 8
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2100
Second-stage test score: 88/104 (84.62%)
Second-stage confusion components -> TP=26, FN=0, FP=8
Second-stage precision=0.7647, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9048    0.9500        84
           1     0.7647    1.0000    0.8667        26

    accuracy                         0.9273       110
   macro avg     0.8824    0.9524    0.9083       110
weighted avg     0.9444    0.9273    0.9303       110

week_sweep_0118: booster=88.0, ensemble=77.0, gain=11.0, dur=110.9s

[119/150] Running week_sweep_0119 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0119: booster=102.0, ensemble=77.0, gain=25.0, dur=132.1s

[120/150] Running week_sweep_0120 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.325         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.3250
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0120: booster=96.0, ensemble=77.0, gain=19.0, dur=126.1s

[121/150] Running week_sweep_0121 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0121: booster=96.0, ensemble=77.0, gain=19.0, dur=147.9s

[122/150] Running week_sweep_0122 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
regularized    1.0       0.50         56               16                0                4          87                25                 1                 6
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0122: booster=96.0, ensemble=77.0, gain=19.0, dur=150.4s

[123/150] Running week_sweep_0123 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
regularized    1.0       0.50         56               16                0                4          87                25                 1                 6
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0123: booster=96.0, ensemble=77.0, gain=19.0, dur=147.2s

[124/150] Running week_sweep_0124 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0       0.18         64               16                0                0          98                26                 0                 3
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1800
Second-stage test score: 98/104 (94.23%)
Second-stage confusion components -> TP=26, FN=0, FP=3
Second-stage precision=0.8966, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9643    0.9818        84
           1     0.8966    1.0000    0.9455        26

    accuracy                         0.9727       110
   macro avg     0.9483    0.9821    0.9636       110
weighted avg     0.9755    0.9727    0.9732       110

week_sweep_0124: booster=98.0, ensemble=77.0, gain=21.0, dur=100.8s

[125/150] Running week_sweep_0125 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0       0.49         52               16                0                6          74                26                 0                15
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.4900
Second-stage test score: 74/104 (71.15%)
Second-stage confusion components -> TP=26, FN=0, FP=15
Second-stage precision=0.6341, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.8214    0.9020        84
           1     0.6341    1.0000    0.7761        26

    accuracy                         0.8636       110
   macro avg     0.8171    0.9107    0.8390       110
weighted avg     0.9135    0.8636    0.8722       110

week_sweep_0125: booster=74.0, ensemble=77.0, gain=-3.0, dur=147.7s

[126/150] Running week_sweep_0126 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0126: booster=96.0, ensemble=77.0, gain=19.0, dur=149.1s

[127/150] Running week_sweep_0127 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.205         57               15                1                1          98                26                 0                 3
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2050
Second-stage test score: 98/104 (94.23%)
Second-stage confusion components -> TP=26, FN=0, FP=3
Second-stage precision=0.8966, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9643    0.9818        84
           1     0.8966    1.0000    0.9455        26

    accuracy                         0.9727       110
   macro avg     0.9483    0.9821    0.9636       110
weighted avg     0.9755    0.9727    0.9732       110

week_sweep_0127: booster=98.0, ensemble=77.0, gain=21.0, dur=107.0s

[128/150] Running week_sweep_0128 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0       0.51         52               14                2                1          90                24                 2                 2
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.5100
Second-stage test score: 90/104 (86.54%)
Second-stage confusion components -> TP=24, FN=2, FP=2
Second-stage precision=0.9231, recall=0.9231
              precision    recall  f1-score   support

           0     0.9762    0.9762    0.9762        84
           1     0.9231    0.9231    0.9231        26

    accuracy                         0.9636       110
   macro avg     0.9496    0.9496    0.9496       110
weighted avg     0.9636    0.9636    0.9636       110

week_sweep_0128: booster=90.0, ensemble=77.0, gain=13.0, dur=110.9s

[129/150] Running week_sweep_0129 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.12         59               15                1                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0129: booster=102.0, ensemble=77.0, gain=25.0, dur=101.0s

[130/150] Running week_sweep_0130 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.305         58               16                0                3          89                25                 1                 5
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.3050
Second-stage test score: 89/104 (85.58%)
Second-stage confusion components -> TP=25, FN=1, FP=5
Second-stage precision=0.8333, recall=0.9615
              precision    recall  f1-score   support

           0     0.9875    0.9405    0.9634        84
           1     0.8333    0.9615    0.8929        26

    accuracy                         0.9455       110
   macro avg     0.9104    0.9510    0.9281       110
weighted avg     0.9511    0.9455    0.9467       110

week_sweep_0130: booster=89.0, ensemble=77.0, gain=12.0, dur=103.4s

[131/150] Running week_sweep_0131 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.265         60               16                0                2          92                26                 0                 6
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2650
Second-stage test score: 92/104 (88.46%)
Second-stage confusion components -> TP=26, FN=0, FP=6
Second-stage precision=0.8125, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9286    0.9630        84
           1     0.8125    1.0000    0.8966        26

    accuracy                         0.9455       110
   macro avg     0.9062    0.9643    0.9298       110
weighted avg     0.9557    0.9455    0.9473       110

week_sweep_0131: booster=92.0, ensemble=77.0, gain=15.0, dur=143.9s

[132/150] Running week_sweep_0132 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.250         58               16                0                3          96                26                 0                 4
regularized    1.0      0.535         55               15                1                2          86                24                 2                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0132: booster=96.0, ensemble=77.0, gain=19.0, dur=148.1s

[133/150] Running week_sweep_0133 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.115         58               16                0                3          92                26                 0                 6
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1150
Second-stage test score: 92/104 (88.46%)
Second-stage confusion components -> TP=26, FN=0, FP=6
Second-stage precision=0.8125, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9286    0.9630        84
           1     0.8125    1.0000    0.8966        26

    accuracy                         0.9455       110
   macro avg     0.9062    0.9643    0.9298       110
weighted avg     0.9557    0.9455    0.9473       110

week_sweep_0133: booster=92.0, ensemble=77.0, gain=15.0, dur=106.7s

[134/150] Running week_sweep_0134 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0134: booster=84.0, ensemble=77.0, gain=7.0, dur=107.3s

[135/150] Running week_sweep_0135 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.25         58               16                0                3          96                26                 0                 4
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2500
Second-stage test score: 96/104 (92.31%)
Second-stage confusion components -> TP=26, FN=0, FP=4
Second-stage precision=0.8667, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9524    0.9756        84
           1     0.8667    1.0000    0.9286        26

    accuracy                         0.9636       110
   macro avg     0.9333    0.9762    0.9521       110
weighted avg     0.9685    0.9636    0.9645       110

week_sweep_0135: booster=96.0, ensemble=77.0, gain=19.0, dur=146.0s

[136/150] Running week_sweep_0136 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    0.9       0.12         64               16                0                0         102                26                 0                 1
regularized    1.0       0.37         58               16                0                3          84                26                 0                10
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 0.90
Second-stage threshold: 0.1200
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0136: booster=102.0, ensemble=77.0, gain=25.0, dur=98.8s

[137/150] Running week_sweep_0137 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0      0.145         64               16                0                0         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.1450
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0137: booster=102.0, ensemble=77.0, gain=25.0, dur=131.9s

[138/150] Running week_sweep_0138 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
regularized    1.0       0.20         56               16                0                4          84                26                 0                10
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2000
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=26, FN=0, FP=10
Second-stage precision=0.7222, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.8810    0.9367        84
           1     0.7222    1.0000    0.8387        26

    accuracy                         0.9091       110
   macro avg     0.8611    0.9405    0.8877       110
weighted avg     0.9343    0.9091    0.9135       110

week_sweep_0138: booster=84.0, ensemble=77.0, gain=7.0, dur=108.1s

[139/150] Running week_sweep_0139 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=3, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      198           71           16           35         370
   42                                      221           72           15           26         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0      0.235         62               16                0                1         100                26                 0                 2
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.2350
Second-stage test score: 100/104 (96.15%)
Second-stage confusion components -> TP=26, FN=0, FP=2
Second-stage precision=0.9286, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9762    0.9880        84
           1     0.9286    1.0000    0.9630        26

    accuracy                         0.9818       110
   macro avg     0.9643    0.9881    0.9755       110
weighted avg     0.9831    0.9818    0.9820       110

week_sweep_0139: booster=100.0, ensemble=77.0, gain=23.0, dur=129.7s

[140/150] Running week_sweep_0140 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
 legacy    1.0       0.67         54               14                2                0          84                22                 4                 0
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: legacy
Second-stage selected profile: legacy
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.6700
Second-stage test score: 84/104 (80.77%)
Second-stage confusion components -> TP=22, FN=4, FP=0
Second-stage precision=1.0000, recall=0.8462
              precision    recall  f1-score   support

           0     0.9545    1.0000    0.9767        84
           1     1.0000    0.8462    0.9167        26

    accuracy                         0.9636       110
   macro avg     0.9773    0.9231    0.9467       110
weighted avg     0.9653    0.9636    0.9625       110

week_sweep_0140: booster=84.0, ensemble=77.0, gain=7.0, dur=106.3s

[141/150] Running week_sweep_0141 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0       0.42         52               16                0                6          75                25                 1                12
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.4200
Second-stage test score: 75/104 (72.12%)
Second-stage confusion components -> TP=25, FN=1, FP=12
Second-stage precision=0.6757, recall=0.9615
              precision    recall  f1-score   support

           0     0.9863    0.8571    0.9172        84
           1     0.6757    0.9615    0.7937        26

    accuracy                         0.8818       110
   macro avg     0.8310    0.9093    0.8554       110
weighted avg     0.9129    0.8818    0.8880       110

week_sweep_0141: booster=75.0, ensemble=77.0, gain=-2.0, dur=106.3s

[142/150] Running week_sweep_0142 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=4)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
     legacy    1.0      0.250         58               16                0                3          96                26                 0                 4
regularized    1.0      0.405         62               16                0                1         102                26                 0                 1
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: auto
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.4050
Second-stage test score: 102/104 (98.08%)
Second-stage confusion components -> TP=26, FN=0, FP=1
Second-stage precision=0.9630, recall=1.0000
              precision    recall  f1-score   support

           0     1.0000    0.9881    0.9940        84
           1     0.9630    1.0000    0.9811        26

    accuracy                         0.9909       110
   macro avg     0.9815    0.9940    0.9876       110
weighted avg     0.9912    0.9909    0.9910       110

week_sweep_0142: booster=102.0, ensemble=77.0, gain=25.0, dur=147.1s

[143/150] Running week_sweep_0143 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13, 42], folds=4, epochs=3)...
Seed-level first-stage account scores (test):
 seed  threshold  test_score  tp_accounts  fn_accounts  fp_accounts
   13      0.335          72           20            6            1
   29      0.325          69           21            5            5
   42      0.520          49           15           11            0
   73      0.660          57           17            9            1
  101      0.380          66           20            6            4
Seed score mean/std: 62.60 / 9.45
Ensemble aggregation: mean
Ensemble selected threshold: 0.3700
Ensemble test score: 77 (TP=21, FN=5, FP=1, accounts=110)
Second-stage fit feature source: oof_first_stage
OOF seed report for second-stage fit features:
 seed  fit_account_score_at_ensemble_threshold  tp_accounts  fn_accounts  fp_accounts  n_accounts
   13                                      232           69           18           13         370
   42                                      245           70           17            9         370
Second-stage candidate report:
    profile  alpha  threshold  val_score  val_tp_accounts  val_fn_accounts  val_fp_accounts  test_score  test_tp_accounts  test_fn_accounts  test_fp_accounts
regularized    1.0       0.41         60               16                0                2          85                25                 1                 7
Baseline account-level validation score (from first-stage means): 45 (TP=13, FN=3, FP=2, threshold=0.3700)
Second-stage profile mode: regularized
Second-stage selected profile: regularized
Second-stage blend alpha (CatBoost weight): 1.00
Second-stage threshold: 0.4100
Second-stage test score: 85/104 (81.73%)
Second-stage confusion components -> TP=25, FN=1, FP=7
Second-stage precision=0.7812, recall=0.9615
              precision    recall  f1-score   support

           0     0.9872    0.9167    0.9506        84
           1     0.7812    0.9615    0.8621        26

    accuracy                         0.9273       110
   macro avg     0.8842    0.9391    0.9063       110
weighted avg     0.9385    0.9273    0.9297       110

week_sweep_0143: booster=85.0, ensemble=77.0, gain=8.0, dur=147.8s

[144/150] Running week_sweep_0144 ...
/tmp/ipython-input-4244567468.py:43: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  timestamp = datetime.utcnow().strftime("%Y-%m-%dT%H:%M:%SZ")
Building OOF first-stage features for second-stage training (seeds=[13], folds=4, epochs=4)...